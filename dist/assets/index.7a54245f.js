(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const s of c.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function r(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerpolicy&&(c.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?c.credentials="include":n.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(n){if(n.ep)return;n.ep=!0;const c=r(n);fetch(n.href,c)}})();const i=()=>{const e=localStorage.getItem("cartProducts");return e?JSON.parse(e):[]},E=e=>{if(!e)throw new Error("Voc\xEA deve fornecer um ID");const r=[...i(),e];localStorage.setItem("cartProducts",JSON.stringify(r))},y=e=>{if(!e)throw new Error("Voc\xEA deve fornecer um ID");const t=[...i()],r=t.findIndex(o=>o.id===e);t.splice(r,1),localStorage.setItem("cartProducts",JSON.stringify(t))};async function v(e){return await(await fetch(`https://cep.awesomeapi.com.br/json/${e}`)).json()}async function P(e){return await(await fetch(`https://brasilapi.com.br/api/cep/v2/${e}`)).json()}const w=async e=>{if(!e)throw new Error("Cep n\xE3o informado");return await Promise.any([v(e),P(e)])},L=async()=>{const e=document.querySelector(".cep-input"),t=document.querySelector(".cart__address");try{const r=await w(e.value);if(r.code==="invalid"||r.type==="service_error")throw Error("CEP n\xE3o encontrado");t.innerHTML=`${r.address||r.street} - ${r.district||r.neighborhood} - ${r.city} - ${r.state}`}catch(r){t.innerHTML=r.message}},I=async e=>{if(!e)throw new Error("ID n\xE3o informado");return await(await fetch(`https://api.mercadolibre.com/items/${e}`)).json()},b=async e=>{if(!e)throw new Error("Termo de busca n\xE3o informado");return(await(await fetch(`https://api.mercadolibre.com/sites/MLB/search?q=${e}`)).json()).results},m=e=>{const t=document.createElement("img");return t.className="product__image",t.src=e.replace("I.jpg","O.jpg"),t},a=(e,t,r="")=>{const o=document.createElement(e);return o.className=t,o.innerText=r,o},S=(e,t)=>{e.remove(),y(t)},_=({id:e,title:t,price:r,pictures:o})=>{const n=document.createElement("li");n.className="cart__product";const c=a("div","cart__product__image-container"),s=m(o[0].url);c.appendChild(s);const l=m((o[1]||o[0]).url);c.appendChild(l),n.appendChild(c);const u=a("div","cart__product__info-container");u.appendChild(a("span","product__title",t));const g=a("span","product__price","R$ ");g.appendChild(a("span","product__price__value",r)),u.appendChild(g),n.appendChild(u);const C=a("i","material-icons cart__product__remove","delete");return n.appendChild(C),n.addEventListener("click",()=>S(n,e)),n},N=({id:e,title:t,thumbnail:r,price:o})=>{const n=document.createElement("section");n.className="product",n.appendChild(a("span","product__id",e));const c=a("div","img__container");c.appendChild(m(r)),n.appendChild(c),n.appendChild(a("span","product__title",t));const s=a("span","product__price","R$ ");s.appendChild(a("span","product__price__value",o)),n.appendChild(s);const l=a("button","product__add","Adicionar ao carrinho!");return n.appendChild(l),n};document.querySelector(".cep-button").addEventListener("click",L);const h=document.querySelector(".products"),d=document.querySelector(".cart__products");function T(){const e=document.createElement("h2");e.innerHTML="Algum erro ocorreu, recarregue a p\xE1gina e tente novamente",e.classList.add("error"),h.appendChild(e)}function p(e){e.length>0&&e[0].remove()}function M(){const e=document.createElement("h2");e.innerHTML="carregando...",e.classList.add("loading"),h.appendChild(e)}async function O(){const e=document.getElementsByClassName("loading"),t=document.getElementsByClassName("error");try{p(t),M();const r=await b("computador");return p(e),r.forEach(o=>{h.appendChild(N(o))})}catch(r){p(e),console.error(r.message),T()}}O();function $(){document.body.addEventListener("click",async e=>{if(e.target.classList.contains("product__add")){const t=e.target.parentNode.querySelector(".product__id").innerHTML,r=await I(t);E(r);const o=_(r);d.appendChild(o)}})}$();function q(){i().forEach(t=>d.appendChild(_(t)))}q();function f(){const e=document.querySelector(".total-price"),r=i().reduce((o,n)=>o+n.price,0);e.innerText=r}f();function D(){const e={childList:!0},t=function(o){o.forEach(n=>{n.type==="childList"&&f()})};new MutationObserver(t).observe(d,e),d.addEventListener("load",f)}D();
